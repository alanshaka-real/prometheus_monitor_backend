# 项目说明

## 概述

Prometheus Monitor Backend 是 Prometheus 集群监控管理平台的后端服务，采用 Spring Boot 3 + MyBatis-Plus + MySQL 技术栈，提供 RESTful API 供前端调用。

## 模块说明

### 业务模块（11 个）

| 模块 | 路径 | 功能 |
|------|------|------|
| auth | `module/auth` | 用户认证、JWT 双令牌、密码管理 |
| datasource | `module/datasource` | Prometheus 实例管理、Exporter 管理、指标元数据 |
| dashboard | `module/dashboard` | 仪表盘 CRUD、模板管理、模板导入 |
| query | `module/query` | PromQL 查询代理、查询历史、模板库 |
| alert | `module/alert` | 告警规则、历史、静默、通知渠道 |
| cluster | `module/cluster` | 集群管理、拓扑映射、健康评分 |
| permission | `module/permission` | 用户/角色/权限 RBAC、审计日志 |
| workspace | `module/workspace` | 工作空间、仪表盘组织 |
| distribute | `module/distribute` | 主机管理、部署任务、软件包、组件配置 |
| panel | `module/panel` | 面板模板管理 |
| settings | `module/settings` | 全局设置、系统日志 |

### 基础设施

| 模块 | 路径 | 功能 |
|------|------|------|
| common | `common/` | 统一响应格式、全局异常处理、分页工具 |
| config | `config/` | Security/WebSocket/Jackson/MyBatis-Plus/Swagger 等配置 |
| security | `security/` | JWT Provider、Authentication Filter |
| websocket | `websocket/` | 部署日志实时推送 |
| annotation | `annotation/` | @AuditLog 审计注解 |
| aspect | `aspect/` | AuditLog AOP 切面 |
| util | `util/` | AES 加密、IP 工具、UUID 生成 |

## Exporter 类型支持

| 类型 | 说明 |
|------|------|
| node_exporter | 主机系统指标（CPU/内存/磁盘/网络） |
| mysql_exporter | MySQL 数据库指标 |
| redis_exporter | Redis 指标 |
| nginx_exporter | Nginx 指标 |
| cadvisor | 容器指标 |
| blackbox_exporter | 黑盒探测（HTTP/TCP/ICMP） |
| process_exporter | 进程级指标 |
| kafka_exporter | Kafka 集群指标 |
| postgres_exporter | PostgreSQL 指标 |
| mongodb_exporter | MongoDB 指标 |
| es_exporter | Elasticsearch 指标 |
| rabbitmq_exporter | RabbitMQ 指标 |
| haproxy_exporter | HAProxy 指标 |

## 通知渠道支持

| 渠道 | 实现方式 |
|------|----------|
| 邮件 | Spring JavaMailSender + SMTP |
| 钉钉 | 企业机器人 Webhook |
| 企业微信 | 群机器人 Webhook |
| Slack | Incoming Webhook |
| Webhook | 通用 HTTP POST |

## 设计模式

- **工厂模式** — 通知渠道发送（NotificationSenderFactory）
- **策略模式** — 组件配置生成（ComponentConfigGenerator）
- **AOP** — 审计日志（@AuditLog 注解驱动）
- **Builder** — 复杂 DTO 构建
- **Repository** — MyBatis-Plus Mapper 数据访问

## 数据安全

- 密码存储：BCrypt 哈希
- SSH 凭据存储：AES256 加密
- API 认证：JWT (HMAC256)
- 逻辑删除：所有业务表 `deleted` 字段
- 主键策略：UUID 随机生成
